var jsPsychCanvasButtonResponse=function(t){"use strict";const e={name:"canvas-button-response",parameters:{stimulus:{type:t.ParameterType.FUNCTION,pretty_name:"Stimulus",default:void 0},choices:{type:t.ParameterType.STRING,pretty_name:"Choices",default:void 0,array:!0},button_html:{type:t.ParameterType.HTML_STRING,pretty_name:"Button HTML",default:'<button class="jspsych-btn">%choice%</button>',array:!0},prompt:{type:t.ParameterType.HTML_STRING,pretty_name:"Prompt",default:null},stimulus_duration:{type:t.ParameterType.INT,pretty_name:"Stimulus duration",default:null},trial_duration:{type:t.ParameterType.INT,pretty_name:"Trial duration",default:null},margin_vertical:{type:t.ParameterType.STRING,pretty_name:"Margin vertical",default:"0px"},margin_horizontal:{type:t.ParameterType.STRING,pretty_name:"Margin horizontal",default:"8px"},response_ends_trial:{type:t.ParameterType.BOOL,pretty_name:"Response ends trial",default:!0},canvas_size:{type:t.ParameterType.INT,array:!0,pretty_name:"Canvas size",default:[500,500]}}};class s{constructor(t){this.jsPsych=t}trial(t,e){function s(s){var a=performance.now(),n=Math.round(a-o);u.button=parseInt(s),u.rt=n,t.querySelector("#jspsych-canvas-button-response-stimulus").className+=" responded";for(var r=document.querySelectorAll(".jspsych-canvas-button-response-button button"),i=0;i<r.length;i++)r[i].setAttribute("disabled","disabled");e.response_ends_trial&&c()}var a='<div id="jspsych-canvas-button-response-stimulus"><canvas id="jspsych-canvas-stimulus" height="'+e.canvas_size[0]+'" width="'+e.canvas_size[1]+'"></canvas></div>',n=[];if(Array.isArray(e.button_html))e.button_html.length==e.choices.length&&(n=e.button_html);else for(var r=0;r<e.choices.length;r++)n.push(e.button_html);a+='<div id="jspsych-canvas-button-response-btngroup">';for(r=0;r<e.choices.length;r++){var i=n[r].replace(/%choice%/g,e.choices[r]);a+='<div class="jspsych-canvas-button-response-button" style="display: inline-block; margin:'+e.margin_vertical+" "+e.margin_horizontal+'" id="jspsych-canvas-button-response-button-'+r+'" data-choice="'+r+'">'+i+"</div>"}a+="</div>",null!==e.prompt&&(a+=e.prompt),t.innerHTML=a;let l=document.getElementById("jspsych-canvas-stimulus");e.stimulus(l);var o=performance.now();for(r=0;r<e.choices.length;r++)t.querySelector("#jspsych-canvas-button-response-button-"+r).addEventListener("click",t=>{s(t.currentTarget.getAttribute("data-choice"))});var u={rt:null,button:null};const c=()=>{this.jsPsych.pluginAPI.clearAllTimeouts();var e={rt:u.rt,response:u.button};t.innerHTML="",this.jsPsych.finishTrial(e)};null!==e.stimulus_duration&&this.jsPsych.pluginAPI.setTimeout(()=>{t.querySelector("#jspsych-canvas-button-response-stimulus").style.visibility="hidden"},e.stimulus_duration),null!==e.trial_duration&&this.jsPsych.pluginAPI.setTimeout(()=>{c()},e.trial_duration)}simulate(t,e,s,a){"data-only"==e&&(a(),this.simulate_data_only(t,s)),"visual"==e&&this.simulate_visual(t,s,a)}create_simulation_data(t,e){const s={rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),response:this.jsPsych.randomization.randomInt(0,t.choices.length-1)},a=this.jsPsych.pluginAPI.mergeSimulationData(s,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,a),a}simulate_data_only(t,e){const s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}simulate_visual(t,e,s){const a=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();this.trial(n,t),s(),null!==a.rt&&this.jsPsych.pluginAPI.clickTarget(n.querySelector(`div[data-choice="${a.response}"] button`),a.rt)}}return s.info=e,s}(jsPsychModule);