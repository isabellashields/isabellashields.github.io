var jsPsychSurveyMultiChoice=function(e){"use strict";const t={name:"survey-multi-choice",parameters:{questions:{type:e.ParameterType.COMPLEX,array:!0,pretty_name:"Questions",nested:{prompt:{type:e.ParameterType.HTML_STRING,pretty_name:"Prompt",default:void 0},options:{type:e.ParameterType.STRING,pretty_name:"Options",array:!0,default:void 0},required:{type:e.ParameterType.BOOL,pretty_name:"Required",default:!1},horizontal:{type:e.ParameterType.BOOL,pretty_name:"Horizontal",default:!1},name:{type:e.ParameterType.STRING,pretty_name:"Question Name",default:""}}},randomize_question_order:{type:e.ParameterType.BOOL,pretty_name:"Randomize Question Order",default:!1},preamble:{type:e.ParameterType.HTML_STRING,pretty_name:"Preamble",default:null},button_label:{type:e.ParameterType.STRING,pretty_name:"Button label",default:"Continue"},autocomplete:{type:e.ParameterType.BOOL,pretty_name:"Allow autocomplete",default:!1}}};class s{constructor(e){this.jsPsych=e}trial(e,t){var s="jspsych-survey-multi-choice",i="";i+='<style id="jspsych-survey-multi-choice-css">',i+=".jspsych-survey-multi-choice-question { margin-top: 2em; margin-bottom: 2em; text-align: left; }.jspsych-survey-multi-choice-text span.required {color: darkred;}.jspsych-survey-multi-choice-horizontal .jspsych-survey-multi-choice-text {  text-align: center;}.jspsych-survey-multi-choice-option { line-height: 2; }.jspsych-survey-multi-choice-horizontal .jspsych-survey-multi-choice-option {  display: inline-block;  margin-left: 1em;  margin-right: 1em;  vertical-align: top;}label.jspsych-survey-multi-choice-text input[type='radio'] {margin-right: 1em;}",i+="</style>",null!==t.preamble&&(i+='<div id="jspsych-survey-multi-choice-preamble" class="jspsych-survey-multi-choice-preamble">'+t.preamble+"</div>"),t.autocomplete?i+='<form id="jspsych-survey-multi-choice-form">':i+='<form id="jspsych-survey-multi-choice-form" autocomplete="off">';for(var r=[],a=0;a<t.questions.length;a++)r.push(a);t.randomize_question_order&&(r=this.jsPsych.randomization.shuffle(r));for(a=0;a<t.questions.length;a++){var o=t.questions[r[a]],n=r[a],u=["jspsych-survey-multi-choice-question"];o.horizontal&&u.push("jspsych-survey-multi-choice-horizontal"),i+='<div id="jspsych-survey-multi-choice-'+n+'" class="'+u.join(" ")+'"  data-name="'+o.name+'">',i+='<p class="jspsych-survey-multi-choice-text survey-multi-choice">'+o.prompt,o.required&&(i+="<span class='required'>*</span>"),i+="</p>";for(var l=0;l<o.options.length;l++){var c="jspsych-survey-multi-choice-option-"+n+"-"+l,y="jspsych-survey-multi-choice-response-"+n,p="jspsych-survey-multi-choice-response-"+n+"-"+l,m=o.required?"required":"";i+='<div id="'+c+'" class="jspsych-survey-multi-choice-option">',i+='<label class="jspsych-survey-multi-choice-text" for="'+p+'">',i+='<input type="radio" name="'+y+'" id="'+p+'" value="'+o.options[l]+'" '+m+"></input>",i+=o.options[l]+"</label>",i+="</div>"}i+="</div>"}i+='<input type="submit" id="'+s+'-next" class="'+s+' jspsych-btn"'+(t.button_label?' value="'+t.button_label+'"':"")+"></input>",i+="</form>",e.innerHTML=i,document.querySelector("form").addEventListener("submit",s=>{s.preventDefault();for(var i=performance.now(),a=Math.round(i-h),o={},n=0;n<t.questions.length;n++){var u,l=e.querySelector("#jspsych-survey-multi-choice-"+n),c="Q"+n;u=null!==l.querySelector("input[type=radio]:checked")?l.querySelector("input[type=radio]:checked").value:"";var y={},p=c;""!==l.attributes["data-name"].value&&(p=l.attributes["data-name"].value),y[p]=u,Object.assign(o,y)}var m={rt:a,response:o,question_order:r};e.innerHTML="",this.jsPsych.finishTrial(m)});var h=performance.now()}simulate(e,t,s,i){"data-only"==t&&(i(),this.simulate_data_only(e,s)),"visual"==t&&this.simulate_visual(e,s,i)}create_simulation_data(e,t){const s={};let i=1e3;for(const t of e.questions){s[t.name?t.name:`Q${e.questions.indexOf(t)}`]=this.jsPsych.randomization.sampleWithoutReplacement(t.options,1)[0],i+=this.jsPsych.randomization.sampleExGaussian(1500,400,.005,!0)}const r={response:s,rt:i,question_order:e.randomize_question_order?this.jsPsych.randomization.shuffle([...Array(e.questions.length).keys()]):[...Array(e.questions.length).keys()]},a=this.jsPsych.pluginAPI.mergeSimulationData(r,t);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,t){const s=this.create_simulation_data(e,t);this.jsPsych.finishTrial(s)}simulate_visual(e,t,s){const i=this.create_simulation_data(e,t),r=this.jsPsych.getDisplayElement();this.trial(r,e),s();const a=Object.entries(i.response);for(let t=0;t<a.length;t++)this.jsPsych.pluginAPI.clickTarget(r.querySelector(`#jspsych-survey-multi-choice-response-${t}-${e.questions[t].options.indexOf(a[t][1])}`),(i.rt-1e3)/a.length*(t+1));this.jsPsych.pluginAPI.clickTarget(r.querySelector("#jspsych-survey-multi-choice-next"),i.rt)}}return s.info=t,s}(jsPsychModule);